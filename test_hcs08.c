/* Capstone Disassembler Engine */
/* M680X Backend by Wolfgang Schwotzer <wolfgang.schwotzer@gmx.net> 2017 */

#include <stdio.h>
#include <string.h>

#include <capstone/platform.h>
#include <capstone/capstone.h>
#include <capstone/m680x.h>
#include "common.h"


#define HCS08_CODE \
  "\x00\x7f\x00\x01\x7f\x00\x0e\x7f\x00\x0f\x7f\x0d" \
  "\x10\x7f\x11\x7f\x1e\x7f\x1f\x7f" \
  "\x20\xFE\x21\x00\x22\x00\x23\x00\x24\x00\x25\x00\x26\x00\x27\x00" \
  "\x28\x00\x29\x00\x2a\x00\x2b\x00\x2c\x00\x2d\x00\x2e\x00\x2f\x00" \
  "\x30\x7f\x31\x7f\x00\x32\x10\x00\x33\x7f\x34\x7f\x35\x7f\x36\x7f\x37\x7f" \
  "\x38\x7f\x39\x7f\x3a\x7f\x3b\x7f\x00\x3c\x7f\x3d\x7f\x3e\x10\x00\x3f\x7f" \
  "\x40\x41\x10\x00\x42\x43\x44\x45\x10\x00\x46\x47\x48\x49\x4a\x4b\x00" \
  "\x4c\x4d\x4e\x7e\x7f\x4f" \
  "\x50\x51\x10\x00\x52\x53\x54\x55\x7f\x56\x57\x58\x59\x5a\x5b\x00" \
  "\x5c\x5d\x5e\x7f\x5f" \
  "\x60\x80\x61\x10\x00\x62\x63\x7f\x64\x7f\x65\x10\x00\x66\x7f\x67\x7f" \
  "\x68\x7f\x69\x7f\x6a\x7f\x6b\x10\x00\x6c\x7f\x6d\x7f\x6e\x10\x7f\x6f\x7f" \
  "\x70\x71\x00\x72\x73\x74\x75\x7f\x76\x77\x78\x79\x7a\x7b\x00\x7c\x7d" \
  "\x7e\x7f\x7f" \
  "\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8e\x8f" \
  "\x90\x00\x91\x00\x92\x00\x93\x00\x94\x95\x96\x10\x00\x97\x98\x99\x9a" \
  "\x9b\x9c\x9d\x9f" \
  "\xa0\x10\xa1\x10\xa2\x10\xa3\x10\xa4\x10\xa5\x10\xa6\x10\xa7\x10" \
  "\xa8\x10\xa9\x10\xaa\x10\xab\x10\xad\x10\xae\x10\xaf\x10" \
  "\xb0\x10\xb1\x10\xb2\x10\xb3\x10\xb4\x10\xb5\x10\xb6\x10" \
  "\xb7\x10\xb8\x10\xb9\x10\xba\x10\xbb\x10\xbc\x10\xbd\x10\xbe\x10\xbf\x10" \
  "\xc0\x10\x00\xc1\x10\x00\xc2\x10\x00\xc3\x10\x00\xc4\x10\x00\xc5\x10\x00" \
  "\xc6\x10\x00\xc7\x10\x00\xc8\x10\x00\xc9\x10\x00\xca\x10\x00\xcb\x10\x00" \
  "\xcc\x10\x00\xcd\x10\x00\xce\x10\x00\xcf\x10\x00" \
  "\xd0\x10\x00\xd1\x10\x00\xd2\x10\x00\xd3\x10\x00\xd4\x10\x00\xd5\x10\x00" \
  "\xd6\x10\x00\xd7\x10\x00\xd8\x10\x00\xd9\x10\x00\xda\x10\x00\xdb\x10\x00" \
  "\xdc\x10\x00\xdd\x10\x00\xde\x10\x00\xdf\x10\x00" \
  "\xe0\x10\xe1\x10\xe2\x10\xe3\x10\xe4\x10\xe5\x10\xe6\x10\xe7\x10" \
  "\xe8\x10\xe9\x10\xea\x10\xeb\x10\xec\x10\xed\x10\xee\x10\xef\x10" \
  "\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff" \
\
  "\x9e\x60\x7f\x9e\x61\x7f\x00\x9e\x63\x7f\x9e\x64\x7f\x9e\x66\x7f" \
  "\x9e\x67\x7f\x9e\x68\x7f\x9e\x69\x7f\x9e\x6a\x7f\x9e\x6b\x7f\x00" \
  "\x9e\x6c\x7f\x9e\x6d\x7f\x9e\x6f\x7f" \
  "\x9e\xae" \
  "\x9e\xbe\x10\x00" \
  "\x9e\xce\x7f" \
  "\x9e\xd0\x10\x00\x9e\xd1\x10\x00\x9e\xd2\x10\x00\x9e\xd3\x10\x00" \
  "\x9e\xd4\x10\x00\x9e\xd5\x10\x00\x9e\xd6\x10\x00\x9e\xd7\x10\x00" \
  "\x9e\xd8\x10\x00\x9e\xd9\x10\x00\x9e\xda\x10\x00\x9e\xdb\x10\x00" \
  "\x9e\xde\x10\x00\x9e\xdf\x10\x00" \
  "\x9e\xe0\x10\x9e\xe1\x10\x9e\xe2\x10\x9e\xe3\x10\x9e\xe4\x10\x9e\xe5\x10\x9e\xe6\x10\x9e\xe7\x10" \
  "\x9e\xe8\x10\x9e\xe9\x10\x9e\xea\x10\x9e\xeb\x10\x9e\xee\x10\x9e\xef\x10" \
  "\x9e\xf3\x7f\x9e\xfe\x7f\x9e\xff\x7f"

#define HCS08_CODE_ILLEGAL \
  "\x8d" \
  "\xac" \
  "\x9e\x62\x9e\x6e" \
  "\x9e\xdc\x9e\xdd" \
  "\x9e\xec\x9e\xed"

int main()
{
  struct platform platforms[] =
  {
    {
      CS_ARCH_M680X,
      (cs_mode)(CS_MODE_M680X_HCS08),
      (unsigned char *)HCS08_CODE,
      sizeof(HCS08_CODE) - 1,
      "M680X_HCS08",
      true,
    },
    {
      CS_ARCH_M680X,
      (cs_mode)(CS_MODE_M680X_HCS08),
      (unsigned char *)HCS08_CODE_ILLEGAL,
      sizeof(HCS08_CODE_ILLEGAL) - 1,
      "M680X_HCS08_ILLEGAL",
      false,
    },
  };

  test(&platforms[0], ARR_SIZE(platforms));

  return 0;
}
