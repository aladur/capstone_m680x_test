/* Capstone Disassembler Engine */
/* M680X Backend by Wolfgang Schwotzer <wolfgang.schwotzer@gmx.net> 2017 */

#include <stdio.h>
#include <string.h>

#include <capstone/platform.h>
#include <capstone/capstone.h>
#include <capstone/m680x.h>
#include "common.h"


#define CPU12_CODE \
  "\x00\x01\x02\x03" \
  "\x04\x00\x00\x04\x01\xff\x04\x14\x00\x04\x15\xff\x04\x06\x00\x04\x07\x00" \
  "\x04\x20\x00\x04\x80\x00\x04\xa0\x00\x04\x40\x00\x04\x60\x00" \
  "\x05\x00\x06\x10\x00\x07\x00\x08\x09\x0a\x0b\x0c\x00\x80\x0d\x00\x80" \
  "\x0e\x00\x80\x00\x0f\x00\x80\x00" \
  "\x10\x80\x11\x12\x13\x14\x80\x15\x00\x16\x10\x00\x17\x00\x19\x00\x1a\x00" \
  "\x1b\x00\x1c\x10\x00\x80\x1d\x10\x00\x80\x1e\x10\x00\x80\x00" \
  "\x1f\x10\x00\x80\x00" \
  "\x20\xFE\x21\x00\x22\x00\x23\x00\x24\x00\x25\x00\x26\x00\x27\x00" \
  "\x28\x00\x29\x00\x2a\x00\x2b\x00\x2c\x00\x2d\x00\x2e\x00\x2f\x00" \
  "\x30\x31\x32\x33\x34\x35\x36\x37" \
  "\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f" \
  "\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x10\x00\x04\x4b\x00\x04" \
  "\x4c\x7f\x80\x4d\x7f\x80\x4e\x7f\x80\x00\x4f\x7f\x80\x00" \
  "\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x7f\x5b\x7f\x5c\x7f\x5d\x7f" \
  "\x5e\x7f\x5f\x7f" \
  "\x60\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00" \
  "\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00" \
  "\x70\x10\x00\x71\x10\x00\x72\x10\x00\x73\x10\x00\x74\x10\x00\x75\x10\x00" \
  "\x76\x10\x00\x77\x10\x00\x78\x10\x00\x79\x10\x00\x7a\x10\x00\x7b\x10\x00" \
  "\x7c\x10\x00\x7d\x10\x00\x7e\x10\x00\x7f\x10\x00" \
  "\x80\x10\x81\x10\x82\x10\x83\x10\x00\x84\x10\x85\x10\x86\x10\x87\x88\x10" \
  "\x89\x10\x8a\x10\x8b\x10\x8c\x10\x00\x8d\x10\x00\x8e\x10\x00\x8f\x10\x00" \
  "\x90\x10\x91\x10\x92\x10\x93\x10\x94\x10\x95\x10\x96\x10\x97\x98\x10" \
  "\x99\x10\x9a\x10\x9b\x10\x9c\x10\x9d\x10\x9e\x10\x9f\x10" \
  "\xa0\x00\xa1\x00\xa2\x00\xa3\x00\xa4\x00\xa5\x00\xa6\x00\xa7\xa8\x00" \
  "\xa9\x00\xaa\x00\xab\x00\xac\x00\xad\x00\xae\x00\xaf\x00" \
  "\xb0\x10\x00\xb1\x10\x00\xb2\x10\x00\xb3\x10\x00\xb4\x10\x00\xb5\x10\x00" \
  "\xb6\x10\x00\xb8\x10\x00\xb9\x10\x00\xba\x10\x00\xbb\x10\x00" \
  "\xbc\x10\x00\xbd\x10\x00\xbe\x10\x00\xbf\x10\x00" \
  "\xc0\x10\xc1\x10\xc2\x10\xc3\x10\x00\xc4\x10\xc5\x10\xc6\x10\xc7\xc8\x10" \
  "\xc9\x10\xca\x10\xcb\x10\xcc\x10\x00\xcd\x10\x00\xce\x10\x00\xcf\x10\x00" \
  "\xd0\x10\xd1\x10\xd2\x10\xd3\x10\xd4\x10\xd5\x10\xd6\x10\xd7\xd8\x10" \
  "\xd9\x10\xda\x10\xdb\x10\xdc\x10\xdd\x10\xde\x10\xdf\x10" \
  "\xe0\x00\xe1\x00\xe2\x00\xe3\x00\xe4\x00\xe5\x00\xe6\x00\xe7\x00\xe8\x00" \
  "\xe9\x00\xea\x00\xeb\x00\xec\x00\xed\x00\xee\x00\xef\x00" \
  "\xf0\x10\x00\xf1\x10\x00\xf2\x10\x00\xf3\x10\x00\xf4\x10\x00\xf5\x10\x00" \
  "\xf6\x10\x00\xf7\x10\x00\xf8\x10\x00\xf9\x10\x00\xfa\x10\x00\xfb\x10\x00" \
  "\xfc\x10\x00\xfd\x10\x00\xfe\x10\x00\xff\x10\x00" \
\
  "\xb7\x20\xb7\x31\xb7\x52\xb7\x23\xb7\x53\xb7\x05\xb7\x75" \
  "\xb7\xa0\xb7\xb1\xb7\xd2\xb7\xa3\xb7\xd3\xb7\x85\xb7\xf5" \
\
  "\xa6\x0f\xa6\x50\xa6\x81\xa6\xdf" \
  "\xa6\xe0\xff\xa6\xf1\x00\xa6\xf2\x7f\xff\xa6\xfa\x80\x00" \
  "\xa6\xe3\x7f\xff\xa6\xeb\x80\x00" \
  "\xa6\x20\xa6\x67\xa6\xaf\xa6\xa8" \
  "\xa6\xe4\xa6\xed\xa6\xf6\xa6\xfe" \
  "\xa6\xe7\xa6\xef\xa6\xf7\xa6\xff" \
\
  "\x18\x00\x00\x30\x39\x18\x00\xe0\x7f\x30\x39\x18\x00\xe2\x7f\xff\x30\x39" \
  "\x18\x01\x00\x10\x00\x18\x01\xe0\x7f\x10\x00\x18\x01\xe2\x7f\xff\x10\x00" \
  "\x18\x02\x00\x00\x18\x02\x00\xe0\x10\x18\x02\x00\xe2\x10\x00" \
  "\x18\x02\xe0\x7b\x00\x18\x02\xe0\x7b\xe0\x10\x18\x02\xe0\x7b\xe2\x10\x00" \
  "\x18\x02\xe2\x30\x39\x00\x18\x02\xe2\x30\x39\xe0\x10" \
  "\x18\x02\xe2\x30\x39\xe2\x10\x00" \
  "\x18\x03\x30\x39\x10\x00\x18\x04\x30\x39\x10\x00" \
  "\x18\x05\x00\x10\x00\x18\x05\xe0\x7b\x10\x00\x18\x05\xe2\x30\x39\x10\x00" \
\
  "\x18\x06\x18\x07" \
\
  "\x18\x08\x00\x7b\x18\x08\xe0\x7f\x7b\x18\x08\xe2\x7f\xff\x7b" \
  "\x18\x09\x00\x10\x00\x18\x09\xe0\x7f\x10\x00\x18\x09\xe2\x7f\xff\x10\x00" \
  "\x18\x0a\x00\x00\x18\x0a\x00\xe0\x10\x18\x0a\x00\xe2\x10\x00" \
  "\x18\x0a\xe0\x7b\x00\x18\x0a\xe0\x7b\xe0\x10\x18\x0a\xe0\x7b\xe2\x10\x00" \
  "\x18\x0a\xe2\x30\x39\x00\x18\x0a\xe2\x30\x39\xe0\x10" \
  "\x18\x0a\xe2\x30\x39\xe2\x10\x00" \
  "\x18\x0b\x7b\x10\x00\x18\x0c\x30\x39\x10\x00" \
  "\x18\x0d\x00\x10\x00\x18\x0d\xe0\x7b\x10\x00\x18\x0d\xe2\x30\x39\x10\x00" \
\
  "\x18\x0e\x18\x0f" \
\
  "\x18\x10\x18\x11\x18\x12\x10\x00\x18\x13\x18\x14\x18\x15" \
  "\x18\x16\x18\x17" \
  "\x18\x18\x00\x18\x19\x00\x18\x1a\x00\x18\x1b\x00\x18\x1c\x00\x18\x1d\x00" \
  "\x18\x1e\x00\x18\x1f\x00" \
  "\x18\x20\x00\x00\x18\x21\x00\x00\x18\x22\x00\x00\x18\x23\x00\x00" \
  "\x18\x24\x00\x00\x18\x25\x00\x00\x18\x26\x00\x00\x18\x27\x00\x00" \
  "\x18\x28\x00\x00\x18\x29\x00\x00\x18\x2a\x00\x00\x18\x2b\x00\x00" \
  "\x18\x2c\x00\x00\x18\x2d\x00\x00\x18\x2e\x00\x00\x18\x2f\x00\x00" \
\
  "\x18\x3a\x18\x3b\x18\x3c\x18\x3d\x00\x18\x3e\x18\x3f\x00"

#define CPU12_CODE_ILLEGAL \
  "\x04\x02\x00\x04\x03\x00" \
  "\x18\x30\x18\x31\x18\x32\x18\x33\x18\x34\x18\x35\x18\x36\x18\x37\x18\x38" \
  "\x18\x39" \
  "\x18\x40\x18\x41\x18\x42\x18\x43\x18\x44\x18\x45\x18\x46\x18\x47" \
  "\x18\x48\x18\x49\x18\x4a\x00\x00\x00\x18\x4b\x00\x00\x18\x4c\x00\x00" \
  "\x18\x4d\x00\x00\x18\x4e\x00\x00\x00\x18\x4f\x00\x00\x00" \
  "\x18\x50\x18\x51\x18\x52\x18\x53\x18\x54\x18\x55\x18\x56\x18\x57" \
  "\x18\x58\x18\x59\x18\x5a\x00\x18\x5b\x00\x18\x5c\x00\x18\x5d\x00" \
  "\x18\x5e\x00\x18\x5f\x00" \
  "\x18\x60\x00\x18\x61\x00\x18\x62\x00\x18\x63\x00\x18\x64\x00\x18" \
  "\x65\x00\x18\x66\x00\x18\x67\x00" \
  "\x18\x68\x00\x18\x69\x00\x18\x6a\x00\x18\x6b\x00\x18\x6c\x00\x18\x6d\x00" \
  "\x18\x6e\x00\x18\x6f\x00" \
  "\x18\x70\x00\x00\x18\x71\x00\x00\x18\x72\x00\x00\x18\x73\x00\x00" \
  "\x18\x74\x00\x00\x18\x75\x00\x00\x18\x77\x00\x00" \
  "\x18\x78\x00\x00\x18\x79\x00\x00\x18\x7a\x00\x00\x18\x7b\x00\x00" \
  "\x18\x7c\x00\x00\x18\x7d\x00\x00\x18\x7e\x00\x00\x18\x7f\x00\x00" \
  "\x18\x80\x00\x18\x81\x00\x18\x82\x00\x18\x83\x00\x00\x18\x84\x00" \
  "\x18\x85\x00\x18\x86\x00\x18\x87" \
  "\x18\x88\x00\x18\x89\x00\x18\x8a\x00\x18\x8b\x00\x18\x8c\x00\x00" \
  "\x18\x8d\x00\x00\x18\x8e\x00\x00\x18\x8f\x00\x00" \
  "\x18\x90\x00\x18\x91\x00\x18\x92\x00\x18\x93\x00\x18\x94\x00\x18\x95\x00" \
  "\x18\x96\x00\x18\x97" \
  "\x18\x98\x00\x18\x99\x00\x18\x9a\x00\x18\x9b\x00\x18\x9c\x00\x18\x9d\x00" \
  "\x18\x9e\x00\x18\x9f\x00" \
  "\x18\xa0\x00\x18\xa1\x00\x18\xa2\x00\x18\xa3\x00\x18\xa4\x00\x18\xa5\x00" \
  "\x18\xa6\x00\x18\xa7" \
  "\x18\xa8\x00\x18\xa9\x00\x18\xaa\x00\x18\xab\x00\x18\xac\x00\x18\xad\x00" \
  "\x18\xae\x00\x18\xaf\x00" \
  "\x18\xb0\x00\x00\x18\xb1\x00\x00\x18\xb2\x00\x00\x18\xb3\x00\x00" \
  "\x18\xb4\x00\x00\x18\xb5\x00\x00\x18\xb6\x00\x00\x18\xb7\x00" \
  "\x18\xb8\x00\x00\x18\xb9\x00\x00\x18\xba\x00\x00\x18\xbb\x00\x00" \
  "\x18\xbc\x00\x00\x18\xbd\x00\x00\x18\xbe\x00\x00\x18\xbf\x00\x00" \
  "\x18\xc0\x00\x18\xc1\x00\x18\xc2\x00\x18\xc3\x00\x00\x18\xc4\x00" \
  "\x18\xc5\x00\x18\xc6\x00\x18\xc7" \
  "\x18\xc8\x00\x18\xc9\x00\x18\xca\x00\x18\xcb\x00\x18\xcc\x00\x00" \
  "\x18\xcd\x00\x00\x18\xce\x00\x00\x18\xcf\x00\x00" \
  "\x18\xd0\x00\x18\xd1\x00\x18\xd2\x00\x18\xd3\x00\x18\xd4\x00\x18\xd5\x00" \
  "\x18\xd6\x00\x18\xd7" \
  "\x18\xd8\x00\x18\xd9\x00\x18\xda\x00\x18\xdb\x00\x18\xdc\x00\x18\xdd\x00" \
  "\x18\xde\x00\x18\xdf\x00" \
  "\x18\xe0\x00\x18\xe1\x00\x18\xe2\x00\x18\xe3\x00\x18\xe4\x00\x18\xe5\x00" \
  "\x18\xe6\x00\x18\xe7\x00" \
  "\x18\xe8\x00\x18\xe9\x00\x18\xea\x00\x18\xeb\x00\x18\xec\x00\x18\xed\x00" \
  "\x18\xee\x00\x18\xef\x00" \
  "\x18\xf0\x00\x00\x18\xf1\x00\x00\x18\xf2\x00\x00\x18\xf3\x00\x00" \
  "\x18\xf4\x00\x00\x18\xf5\x00\x00\x18\xf6\x00\x00\x18\xf7\x00\x00" \
  "\x18\xf8\x00\x00\x18\xf9\x00\x00\x18\xfa\x00\x00\x18\xfb\x00\x00" \
  "\x18\xfc\x00\x00\x18\xfd\x00\x00\x18\xfe\x00\x00\x18\xff\x00\x00" \

int main()
{
  struct platform platforms[] =
  {
    {
      CS_ARCH_M680X,
      (cs_mode)(CS_MODE_M680X_CPU12),
      (unsigned char *)CPU12_CODE,
      sizeof(CPU12_CODE) - 1,
      "M680X_CPU12",
      true,
    },
    {
      CS_ARCH_M680X,
      (cs_mode)(CS_MODE_M680X_CPU12),
      (unsigned char *)CPU12_CODE_ILLEGAL,
      sizeof(CPU12_CODE_ILLEGAL) - 1,
      "M680X_CPU12_ILLEGAL",
      false,
    },
  };

  test(&platforms[0], ARR_SIZE(platforms));

  return 0;
}
